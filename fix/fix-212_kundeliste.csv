current-window:width = 300.

def var piLoop as int no-undo.
def var cFilNavn as char no-undo.

assign
  cFilNavn = 'c:\appdir\EANListe' + 
              REPLACE(STRING(TODAY),'/','') + 
              '_' +
              REPLACE(STRING(TIME,"HH:MM:SS"),':','') +
              '.csv'
  .

def temp-table EANListe 
  field Strekkode as char format "x(20)"
  field Bongtekst as char format "x(25)"
  field ArtikkelNr as char format "x(20)"
  field Storrelse as char format "x(10)"
  field Pris as dec format "->>>,>>>,>>9.99"
  field Dato as date format "99/99/9999"
  index EAN Strekkode.
def stream Ut.
  
BLOKKEN:  
for each BongHode no-lock where
  BongHode.ButikkNr = 212 and 
  BongHode.Dato >= 01/01/2010 and 
  BongHode.KundeNr > 0:
  
  
  piLoop = piLoop + 1.
  display
  BongHode.Dato
  BongHode.BongNr
  BongHode.KundeNr
  BongHode.KundeKort
  BongHode.KundeNavn  
  with width 300.
  /*  
  if piLoop > 100 then   
  LEAVE BLOKKEN.  
  */
end. /* BLOKKEN */

/*
/* Legger ut alle EAN koder */
output stream Ut to value(cFilNavn) no-echo.
for each EANListe:
  put stream Ut unformatted
  EANListe.Strekkode ';'
  EANListe.BongTekst ';'
  EANListe.ArtikkelNr ';'
  EANListe.Storrelse ';'
  EANListe.Dato ';'
  EANListe.Pris
  skip.
end.
output stream Ut close.
*/
