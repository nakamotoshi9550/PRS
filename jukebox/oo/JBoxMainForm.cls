/*------------------------------------------------------------------------
    File        : MainForm
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : Brynjar Hasle (modeled from autoedge / pjudge)
    Created     : 29.08.2011
    Notes       :
    Modified    : 15.10.15 by Brynjar
                  - uses menuToolImgList for menu tool images.   
  ----------------------------------------------------------------------*/
USING Progress.Windows.Form FROM ASSEMBLY.
USING Infragistics.Win.UltraWinStatusBar.* FROM ASSEMBLY.
USING Infragistics.Win.UltraWinToolbars.* FROM ASSEMBLY.
USING Infragistics.Win.UltraWinTabs.* FROM ASSEMBLY.
USING Infragistics.Win.UltraWinGrid.DocumentExport.* FROM ASSEMBLY. 
/*USING Infragistics.Win.AppStyling.* FROM ASSEMBLY.*/
/*USING Infragistics.Win.AppStyling.StyleManager FROM ASSEMBLY.*/

CLASS JBoxMainForm INHERITS Form :
        
  DEFINE VARIABLE fViewProcedure AS HANDLE     NO-UNDO.
    
  DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer NO-UNDO.
  DEFINE PRIVATE VARIABLE ultraStatusBar1 AS Infragistics.Win.UltraWinStatusBar.UltraStatusBar NO-UNDO.
  DEFINE PRIVATE VARIABLE ultraToolbarsManager1 AS Infragistics.Win.UltraWinToolbars.UltraToolbarsManager NO-UNDO.
  DEFINE PRIVATE VARIABLE m_MainForm2_Toolbars_Dock_Area_Left AS Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea NO-UNDO.
  DEFINE PRIVATE VARIABLE m_MainForm2_Toolbars_Dock_Area_Right AS Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea NO-UNDO.
  DEFINE PRIVATE VARIABLE m_MainForm2_Toolbars_Dock_Area_Top AS Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea NO-UNDO.
  DEFINE PRIVATE VARIABLE m_MainForm2_Toolbars_Dock_Area_Bottom AS Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea NO-UNDO.

  DEFINE PRIVATE VARIABLE ultraTabbedMdiManager1 AS Infragistics.Win.UltraWinTabbedMdi.UltraTabbedMdiManager NO-UNDO.
  
  DEF PRIVATE VARIABLE menuToolImgList AS System.Windows.Forms.ImageList NO-UNDO. 
  
  DEFINE PUBLIC PROPERTY cQuickAccessNodes AS CHARACTER NO-UNDO GET. SET.
  DEFINE PUBLIC PROPERTY TabOrientation AS CHARACTER NO-UNDO 
         GET(): RETURN STRING(THIS-OBJECT:ultraTabbedMdiManager1:Orientation). END GET.
         SET(icOrientation AS CHAR):
           IF icOrientation BEGINS "ver" THEN 
             THIS-OBJECT:ultraTabbedMdiManager1:Orientation = System.Windows.Forms.Orientation:Vertical.
           ELSE  
             THIS-OBJECT:ultraTabbedMdiManager1:Orientation = System.Windows.Forms.Orientation:Horizontal.
         END SET.

	CONSTRUCTOR PUBLIC JBoxMainForm( ):
		SUPER().
		InitializeComponent ( ).
/*		file-info:file-name = "ico\finish.ico".                             */
/*		THIS-OBJECT:Icon = NEW System.Drawing.Icon(file-info:full-pathname).*/
	END CONSTRUCTOR.	
	
  CONSTRUCTOR PUBLIC JBoxMainForm (phController AS HANDLE):
	  THIS-OBJECT().
	    
	  fViewProcedure = phController.

    ultraTabbedMdiManager1:Enabled = YES.
	    
  END CONSTRUCTOR.

  DESTRUCTOR PUBLIC JBoxMainForm ( ):
    IF VALID-OBJECT(components) THEN DO:
      CAST(components, System.IDisposable):Dispose().
    END.
    IF PROVERSION > "10.2B" THEN
      THIS-OBJECT:Dispose().
  END DESTRUCTOR.

	METHOD PRIVATE VOID InitializeComponent ( ):

    menuToolImgList = NEW System.Windows.Forms.ImageList().
/* 		NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

		We strongly suggest that the contents of this method only be modified using the
		Visual Designer to avoid any incompatible modifications.

		Modifying the contents of this method using a code editor will invalidate any support for this file. */


    THIS-OBJECT:components = NEW System.ComponentModel.Container().
    @VisualDesigner.FormMember (NeedsInitialize="true").
    DEFINE VARIABLE optionSet1 AS Infragistics.Win.UltraWinToolbars.OptionSet NO-UNDO.
    optionSet1 = NEW Infragistics.Win.UltraWinToolbars.OptionSet("TabOrientation").
    THIS-OBJECT:ultraToolbarsManager1 = NEW Infragistics.Win.UltraWinToolbars.UltraToolbarsManager(THIS-OBJECT:components).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left = NEW Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea().
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right = NEW Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea().
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top = NEW Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea().
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom = NEW Infragistics.Win.UltraWinToolbars.UltraToolbarsDockArea().
    THIS-OBJECT:ultraTabbedMdiManager1 = NEW Infragistics.Win.UltraWinTabbedMdi.UltraTabbedMdiManager(THIS-OBJECT:components).
    THIS-OBJECT:ultraStatusBar1 = NEW Infragistics.Win.UltraWinStatusBar.UltraStatusBar().
    THIS-OBJECT:ultraTabbedMdiManager1:InitializeTab:Subscribe(THIS-OBJECT:OnTabInitialized).
    CAST(THIS-OBJECT:ultraToolbarsManager1, System.ComponentModel.ISupportInitialize):BeginInit().
    CAST(THIS-OBJECT:ultraTabbedMdiManager1, System.ComponentModel.ISupportInitialize):BeginInit().
    THIS-OBJECT:SuspendLayout().
    /*  */
    /* ultraToolbarsManager1 */
    /*  */
    THIS-OBJECT:ultraToolbarsManager1:DesignerFlags = 1.
    THIS-OBJECT:ultraToolbarsManager1:DockWithinContainer = THIS-OBJECT.
    THIS-OBJECT:ultraToolbarsManager1:DockWithinContainerBaseType = Progress.Util.TypeHelper:GetType("Progress.Windows.Form").
    optionSet1:AllowAllUp = FALSE.
    THIS-OBJECT:ultraToolbarsManager1:OptionSets:Add(optionSet1).
    THIS-OBJECT:ultraToolbarsManager1:Ribbon:ApplicationMenu:ToolAreaRight:Settings:ToolDisplayStyle = Infragistics.Win.UltraWinToolbars.ToolDisplayStyle:ImageAndText.
    THIS-OBJECT:ultraToolbarsManager1:Ribbon:Caption = "Sports2000".
    THIS-OBJECT:ultraToolbarsManager1:Ribbon:Visible = TRUE.
    THIS-OBJECT:ultraToolbarsManager1:ShowFullMenusDelay = 500.
    THIS-OBJECT:ultraToolbarsManager1:ToolClick:Subscribe(THIS-OBJECT:OnToolClick).
    THIS-OBJECT:ultraToolbarsManager1:AfterRibbonTabSelected:Subscribe(THIS-OBJECT:OnRibbonTabSelected).
    THIS-OBJECT:ultraToolbarsManager1:QuickAccessToolbarModified:Subscribe(THIS-OBJECT:OnQATmodified).
    THIS-OBJECT:ultraToolbarsManager1:Office2007UICompatibility = FALSE.        
    THIS-OBJECT:ultraToolbarsManager1:AutoGenerateKeyTips = FALSE.        
           /*  */
    /* m_MainForm2_Toolbars_Dock_Area_Left */
    /*  */
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:AccessibleRole = System.Windows.Forms.AccessibleRole:Grouping.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:BackColor = System.Drawing.Color:FromArgb(System.Convert:ToInt32(System.Convert:ToByte(191)), System.Convert:ToInt32(System.Convert:ToByte(219)), System.Convert:ToInt32(System.Convert:ToByte(255))).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:DockedPosition = Infragistics.Win.UltraWinToolbars.DockedPosition:Left.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:ForeColor = System.Drawing.SystemColors:ControlText.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:InitialResizeAreaExtent = 4.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:Location = NEW System.Drawing.Point(0, 51).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:Name = "m_MainForm2_Toolbars_Dock_Area_Left".
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:Size = NEW System.Drawing.Size(4, 591).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left:ToolbarsManager = THIS-OBJECT:ultraToolbarsManager1.
    /*  */
    /* m_MainForm2_Toolbars_Dock_Area_Right */
    /*  */
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:AccessibleRole = System.Windows.Forms.AccessibleRole:Grouping.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:BackColor = System.Drawing.Color:FromArgb(System.Convert:ToInt32(System.Convert:ToByte(191)), System.Convert:ToInt32(System.Convert:ToByte(219)), System.Convert:ToInt32(System.Convert:ToByte(255))).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:DockedPosition = Infragistics.Win.UltraWinToolbars.DockedPosition:Right.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:ForeColor = System.Drawing.SystemColors:ControlText.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:InitialResizeAreaExtent = 4.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:Location = NEW System.Drawing.Point(796, 51).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:Name = "m_MainForm2_Toolbars_Dock_Area_Right".
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:Size = NEW System.Drawing.Size(4, 591).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right:ToolbarsManager = THIS-OBJECT:ultraToolbarsManager1.
    /*  */
    /* m_MainForm2_Toolbars_Dock_Area_Top */
    /*  */
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:AccessibleRole = System.Windows.Forms.AccessibleRole:Grouping.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:BackColor = System.Drawing.Color:FromArgb(System.Convert:ToInt32(System.Convert:ToByte(191)), System.Convert:ToInt32(System.Convert:ToByte(219)), System.Convert:ToInt32(System.Convert:ToByte(255))).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:DockedPosition = Infragistics.Win.UltraWinToolbars.DockedPosition:Top.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:ForeColor = System.Drawing.SystemColors:ControlText.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:Location = NEW System.Drawing.Point(0, 0).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:Name = "m_MainForm2_Toolbars_Dock_Area_Top".
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:Size = NEW System.Drawing.Size(800, 51).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top:ToolbarsManager = THIS-OBJECT:ultraToolbarsManager1.
    /*  */
    /* m_MainForm2_Toolbars_Dock_Area_Bottom */
    /*  */
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:AccessibleRole = System.Windows.Forms.AccessibleRole:Grouping.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:BackColor = System.Drawing.Color:FromArgb(System.Convert:ToInt32(System.Convert:ToByte(191)), System.Convert:ToInt32(System.Convert:ToByte(219)), System.Convert:ToInt32(System.Convert:ToByte(255))).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:DockedPosition = Infragistics.Win.UltraWinToolbars.DockedPosition:Bottom.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:ForeColor = System.Drawing.SystemColors:ControlText.
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:Location = NEW System.Drawing.Point(0, 642).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:Name = "m_MainForm2_Toolbars_Dock_Area_Bottom".
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:Size = NEW System.Drawing.Size(800, 0).
    THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom:ToolbarsManager = THIS-OBJECT:ultraToolbarsManager1.
    /*  */
    /* ultraTabbedMdiManager1 */
    /*  */
    THIS-OBJECT:ultraTabbedMdiManager1:AllowNestedTabGroups = Infragistics.Win.DefaultableBoolean:True.
    THIS-OBJECT:ultraTabbedMdiManager1:Orientation = System.Windows.Forms.Orientation:Vertical.
    THIS-OBJECT:ultraTabbedMdiManager1:Enabled = FALSE.
    THIS-OBJECT:ultraTabbedMdiManager1:MdiParent = THIS-OBJECT.
/*    THIS-OBJECT:ultraTabbedMdiManager1:TabClosing:Subscribe(THIS-OBJECT:OnTabClosing).*/

/*    DEFINE VARIABLE propVal AS Infragistics.Win.DefaultableBoolean NO-UNDO.*/
/*    propVal = NEW Infragistics.Win.DefaultableBoolean().                   */
/*    MESSAGE propVal:value__                                                */
/*    VIEW-AS ALERT-BOX.                                                     */
/*    propVal = System.Windows.Forms.Orientation.                       */
/*    THIS-OBJECT:ultraTabbedMdiManager1:AllowNestedTabGroups = CAST(Progress.Util.EnumHelper:ReferenceEquals(propVal:True),Infragistics.Win.DefaultableBoolean).*/
/*    DEFINE VARIABLE class1 AS CLASS System.Windows.Forms.Orientation.*/
/*    class1 = NEW System.Windows.Forms.Orientation().                 */
/*    THIS-OBJECT:ultraTabbedMdiManager1:Orientation = class1.Vertical.*/
/*        THIS-OBJECT:ultraTabbedMdiManager1:ViewStyle = Infragistics.Win.UltraWinTabbedMdi.ViewStyle:VisualStudio2005.*/
    /*  */
    /* ultraStatusBar1 */
    /*  */
    /*
    THIS-OBJECT:ultraStatusBar1:Location = NEW System.Drawing.Point(0, 642).
    THIS-OBJECT:ultraStatusBar1:Name = "ultraStatusBar1".
    THIS-OBJECT:ultraStatusBar1:Size = NEW System.Drawing.Size(800, 23).
    THIS-OBJECT:ultraStatusBar1:TabIndex = 5.
    THIS-OBJECT:ultraStatusBar1:Text = "ultraStatusBar1".
    */
    DEFINE VARIABLE ultraStatusPanel1 AS Infragistics.Win.UltraWinStatusBar.UltraStatusPanel NO-UNDO.
    ultraStatusPanel1 = NEW Infragistics.Win.UltraWinStatusBar.UltraStatusPanel().
    @VisualDesigner.FormMember (NeedsInitialize="true").
    DEFINE VARIABLE ultraStatusPanel2 AS Infragistics.Win.UltraWinStatusBar.UltraStatusPanel NO-UNDO.
    ultraStatusPanel2 = NEW Infragistics.Win.UltraWinStatusBar.UltraStatusPanel().
    @VisualDesigner.FormMember (NeedsInitialize="true").
    DEFINE VARIABLE ultraStatusPanel3 AS Infragistics.Win.UltraWinStatusBar.UltraStatusPanel NO-UNDO.
    ultraStatusPanel3 = NEW Infragistics.Win.UltraWinStatusBar.UltraStatusPanel().
    
    THIS-OBJECT:ultraStatusBar1:BorderStylePanel = Infragistics.Win.UIElementBorderStyle:Rounded4Thick.
    THIS-OBJECT:ultraStatusBar1:Location = NEW System.Drawing.Point(0, 505).
    THIS-OBJECT:ultraStatusBar1:Name = "ultraStatusBar1".
    ultraStatusPanel1:Key = "SPANEL_TEXT".
    ultraStatusPanel1:MinWidth = 100.
    ultraStatusPanel1:SizingMode = Infragistics.Win.UltraWinStatusBar.PanelSizingMode:Automatic.
    ultraStatusPanel1:Width = 200.
    ultraStatusPanel2:BorderStyle = Infragistics.Win.UIElementBorderStyle:Dotted.
    ultraStatusPanel2:Key = "SPANEL_TIME".
    ultraStatusPanel2:SizingMode = Infragistics.Win.UltraWinStatusBar.PanelSizingMode:Automatic.
    ultraStatusPanel2:Style = Infragistics.Win.UltraWinStatusBar.PanelStyle:Time.
    ultraStatusPanel3:BorderStyle = Infragistics.Win.UIElementBorderStyle:None.
    ultraStatusPanel3:Key = "SPANEL_DATE".
    ultraStatusPanel3:SizingMode = Infragistics.Win.UltraWinStatusBar.PanelSizingMode:Automatic.
    ultraStatusPanel3:Style = Infragistics.Win.UltraWinStatusBar.PanelStyle:Date.
    @VisualDesigner.FormMember (NeedsInitialize="false", InitializeArray="true").
    DEFINE VARIABLE arrayvar16 AS Infragistics.Win.UltraWinStatusBar.UltraStatusPanel EXTENT 3 NO-UNDO.
    arrayvar16[1] = ultraStatusPanel1.
    arrayvar16[2] = ultraStatusPanel2.
    arrayvar16[3] = ultraStatusPanel3.
    THIS-OBJECT:ultraStatusBar1:Panels:AddRange(arrayvar16).
    THIS-OBJECT:ultraStatusBar1:Size = NEW System.Drawing.Size(704, 23).
    THIS-OBJECT:ultraStatusBar1:TabIndex = 6.
    THIS-OBJECT:ultraStatusBar1:Text = "ultraStatusBar1".
    THIS-OBJECT:ultraStatusBar1:ViewStyle = Infragistics.Win.UltraWinStatusBar.ViewStyle:VisualStudio2005.
    
    /*  */
    /* JBoxMainForm */
    /*  */
    THIS-OBJECT:AutoScaleDimensions = NEW System.Drawing.SizeF(6, 13).
    THIS-OBJECT:AutoScaleMode = System.Windows.Forms.AutoScaleMode:Font.
    THIS-OBJECT:ClientSize = NEW System.Drawing.Size(800, 665).
    THIS-OBJECT:Controls:Add(THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Left).
    THIS-OBJECT:Controls:Add(THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Right).
    THIS-OBJECT:Controls:Add(THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Top).
    THIS-OBJECT:Controls:Add(THIS-OBJECT:m_MainForm2_Toolbars_Dock_Area_Bottom).
    THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraStatusBar1).
    THIS-OBJECT:IsMdiContainer = TRUE.
    THIS-OBJECT:Name = "JBoxMainForm".
    THIS-OBJECT:Text = "Main Window".
    THIS-OBJECT:FormClosed:Subscribe(THIS-OBJECT:OnFormClosed).
    THIS-OBJECT:ResizeBegin:Subscribe(THIS-OBJECT:OnResizeBegin).
    THIS-OBJECT:ResizeEnd:Subscribe(THIS-OBJECT:OnResizeEnd).
    CAST(THIS-OBJECT:ultraToolbarsManager1, System.ComponentModel.ISupportInitialize):EndInit().
    CAST(THIS-OBJECT:ultraTabbedMdiManager1, System.ComponentModel.ISupportInitialize):EndInit().
    THIS-OBJECT:ResumeLayout(FALSE).

    CATCH e AS Progress.Lang.Error:
        UNDO, THROW e.
    END CATCH.
	END METHOD.
	
	METHOD PRIVATE VOID OnToolClick( INPUT sender AS System.Object, INPUT e AS Infragistics.Win.UltraWinToolbars.ToolClickEventArgs ):
	  RUN EventHandler IN fViewProcedure ('ToolClick':u, sender, e).
				
		RETURN.
	END METHOD.

	METHOD PUBLIC VOID OnMdiChildFormClosing( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.FormClosingEventArgs ):
	  IF e:CloseReason:ToString() = "UserClosing" OR e:CloseReason:ToString() = "MdiFormClosing" THEN DO: 
      RUN EventHandler IN fViewProcedure ('FormClosing':u, sender, e).
	    IF RETURN-VALUE = 'cancel' THEN 
        e:Cancel = YES.
    END.                                            		      
    RETURN.
	END METHOD.

  METHOD PUBLIC VOID OnFormClosed( INPUT sender AS System.Object, INPUT e AS System.Windows.Forms.FormClosedEventArgs ):
    RUN EventHandler IN fViewProcedure ('FormClosed':u, sender, e).
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID OnResizeBegin( INPUT sender AS System.Object, INPUT e AS CLASS System.EventArgs ):
/*    MESSAGE "Resize begin" view-as alert-box.*/
    RETURN.
  END METHOD.
  
  METHOD PUBLIC VOID OnResizeEnd( INPUT sender AS System.Object, INPUT e AS CLASS System.EventArgs ):
    RUN ViewCurrTab IN fViewProcedure.
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID OnMdiChildFormActivated(sender AS CLASS System.Object, e AS CLASS System.EventArgs):
    RUN EventHandler IN fViewProcedure ('FormActivated':u, sender, e).
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID OnTabInitialized(sender AS CLASS System.Object, e AS Infragistics.Win.UltraWinTabbedMdi.MdiTabEventArgs):
    RUN EventHandler IN fViewProcedure ('TabInitialized':u, sender, e).
/*    e:Tab:MoveToNewGroup().*/
  END METHOD.    

  METHOD PUBLIC VOID OnRibbonTabSelected(sender AS CLASS System.Object, e AS CLASS System.EventArgs):
    RUN EventHandler IN fViewProcedure ('TabSelected':u, sender, e).
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID OnQATmodified(sender AS CLASS System.Object, e AS CLASS Infragistics.Win.UltraWinToolbars.QuickAccessToolbarModifiedEventArgs):
    DEF VAR iIdx AS INT NO-UNDO.

    iIdx = ultraToolbarsManager1:Tools:IndexOf(e:Tool:KEY) NO-ERROR.

    IF NOT ERROR-STATUS:ERROR THEN DO:
      IF iIdx NE -1 AND STRING(e:QuickAccessToolbarChangeType) = "ToolAdded" 
         AND CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedPropsInternal:AppearancesSmall:Appearance:Image = ?
         THEN DO:
        IF SEARCH("tvpics\FoldOpen.bmp") NE ? AND TYPE-OF(CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase),Infragistics.Win.UltraWinToolbars.PopupMenuTool) THEN
          CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedPropsInternal:AppearancesSmall:Appearance:Image = System.Drawing.Image:FromFile(SEARCH("tvpics\FoldOpen.bmp")).
        ELSE IF SEARCH("bmp\log16e.bmp") NE ? THEN
          CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedPropsInternal:AppearancesSmall:Appearance:Image = System.Drawing.Image:FromFile(SEARCH("bmp\log16e.bmp")).
      END.
    END.

  END METHOD.

  METHOD PRIVATE VOID OnKeyDown (sender AS CLASS System.Object, e AS CLASS System.Windows.Forms.KeyEventArgs):
    DEF VAR hToolbar AS HANDLE NO-UNDO.

/*     MESSAGE e                              */
/*         VIEW-AS ALERT-BOX INFO BUTTONS OK. */
/*     IF e:Control THEN DO:                                                           */
/*       IF VALID-HANDLE(hBrwBufQry) THEN                                              */
/*         hToolbar = DYNAMIC-FUNCTION("GetLinkedObject",hBrwBufQry,"toolbar","from"). */
/*       IF VALID-HANDLE(hToolbar) THEN DO:                                            */
/*         CASE STRING(e:KEYCODE):                                                     */
/*           WHEN "s" THEN RUN InvokeMethod(hToolbar,"SaveRecord").                    */
/*           WHEN "z" THEN RUN InvokeMethod(hToolbar,"UndoRecord").                    */
/*           WHEN "n" THEN RUN InvokeMethod(hToolbar,"NewRecord").                     */
/*         END CASE.                                                                   */
/*       END.                                                                          */
/*     END.                                                                            */

  END METHOD. 


  METHOD PUBLIC VOID DisableMenuItem (piMenuItem AS INT):
    DEF VAR iIdx AS INT NO-UNDO.
    
    /* this will disable the tool whereever it appears on this toolbar. */
    iIdx = ultraToolbarsManager1:Tools:IndexOf(STRING(piMenuItem)).
    IF iIdx NE -1 THEN 
      CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedProps:Enabled = NO.
    
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID EnableMenuItem (piMenuItem AS INT):
    DEF VAR iIdx AS INT NO-UNDO.
    
    /* this will enable the tool whereever it appears on this toolbar. */ 
    iIdx = ultraToolbarsManager1:Tools:IndexOf(STRING(piMenuItem)).
    IF iIdx NE -1 THEN 
      CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedProps:Enabled = YES.
    
    RETURN.
  END METHOD.

  METHOD PUBLIC VOID SetStatusMenuItem (ioTool AS Progress.Lang.Object,
                                        INPUT ibChecked AS LOG):

    DEFINE VARIABLE ButtonTool1 AS Infragistics.Win.UltraWinToolbars.StateButtonTool NO-UNDO.
    ButtonTool1 = CAST(ioTool,"Infragistics.Win.UltraWinToolbars.StateButtonTool").
    IF ibChecked NE ? THEN
      ButtonTool1:Checked = ibChecked.
    ELSE 
      ButtonTool1:Checked = NOT ButtonTool1:Checked.
    
    RETURN.
  END METHOD.

  METHOD PUBLIC Progress.Lang.Object getToolbarHandle (OUTPUT ocType AS CHAR):
    ocType = ultraToolbarsManager1:GetClass():TypeName.
    RETURN CAST(ultraToolbarsManager1,"Progress.Lang.Object"). 
  END METHOD.    
  
  METHOD PUBLIC CHARACTER getStatusText ():
    DEF VAR panelText AS UltraStatusPanel NO-UNDO.
    panelText = ultraStatusBar1:Panels[ultraStatusBar1:Panels:IndexOf("SPANEL_TEXT":u)].
    RETURN panelText:Text. 
  END METHOD.
          
  METHOD PUBLIC VOID setStatusText (icText AS CHAR):
    DEF VAR panelText AS UltraStatusPanel NO-UNDO.
    panelText = ultraStatusBar1:Panels[ultraStatusBar1:Panels:IndexOf("SPANEL_TEXT":u)].
    panelText:Text = icText.
    RETURN. 
  END METHOD.        
    
  METHOD PUBLIC VOID setBgImage(INPUT icBgImage AS CHAR):
      THIS-OBJECT:BackgroundImage = System.Drawing.Image:FromFile(SEARCH(icBgImage)).
/*         THIS-OBJECT:BackgroundImage = CAST(resGlobal:GetObject(icBgImage), System.Drawing.Image). */
  END METHOD.
    
  METHOD PUBLIC VOID setIconImage(INPUT icIconImage AS CHAR):
/*         THIS-OBJECT:Icon = System.Drawing.Icon:FromFile(SEARCH(icIconImage)). */
/*         THIS-OBJECT:Icon = CAST(resGlobal:GetObject(icIconImage), System.Drawing.Icon). */
  END METHOD.

  METHOD PUBLIC VOID setRibbonIconImage(INPUT icIconImage AS CHAR):
    IF SEARCH(icIconImage) NE ? THEN
      THIS-OBJECT:ultraToolbarsManager1:Ribbon:ApplicationMenuButtonImage = System.Drawing.Image:FromFile(SEARCH(icIconImage)).
/*         THIS-OBJECT:ultraToolbarsManager1:Ribbon:ApplicationMenuButtonImage = CAST(resGlobal:GetObject(icIconImage), System.Drawing.Image). */
  END METHOD.

  METHOD PUBLIC VOID setRibbonMinimized (INPUT ibMinimized AS LOG):
     THIS-OBJECT:ultraToolbarsManager1:Ribbon:IsMinimized = ibMinimized.               
  END METHOD.
        
  METHOD PUBLIC VOID setWindowTitle(INPUT icWindowTitle AS CHAR):
      THIS-OBJECT:ultraToolbarsManager1:Ribbon:Caption = icWindowTitle.
  END METHOD.

  METHOD PUBLIC LOGICAL setAppStyleSheet(INPUT icStyleSheet AS CHAR):
    IF SEARCH(icStyleSheet) NE ? THEN DO:
/*      Infragistics.Win.AppStyling.StyleManager:Load(SEARCH(icStyleSheet)).                                         */
/*      THIS-OBJECT:ultraTabbedMdiManager1:ViewStyle = Infragistics.Win.UltraWinTabbedMdi.ViewStyle:VisualStudio2005.*/
      RETURN YES.
    END.    
    RETURN NO.
  END METHOD.   
    
  METHOD PUBLIC Progress.Lang.Object AddRibbonTab (iiId AS INT, icText AS CHAR,OUTPUT ocType AS CHAR ):
      
    DEFINE VARIABLE ribbonTab1 AS Infragistics.Win.UltraWinToolbars.RibbonTab NO-UNDO.
    ribbonTab1 = NEW Infragistics.Win.UltraWinToolbars.RibbonTab(STRING(iiId)).

    ocType = ribbonTab1:GetClass():TypeName.
    
    ribbonTab1:Caption = icText.
    DEFINE VARIABLE arrayvar0 AS Infragistics.Win.UltraWinToolbars.RibbonTab EXTENT 1 NO-UNDO.
    arrayvar0[1] = ribbonTab1.
    THIS-OBJECT:ultraToolbarsManager1:Ribbon:NonInheritedRibbonTabs:AddRange(arrayvar0).

    RETURN CAST(ribbonTab1,"Progress.Lang.Object"). 
  END METHOD.        

  METHOD PUBLIC Progress.Lang.Object AddRibbonGroup 
        (ioParent AS Progress.Lang.Object,
         icParentType AS CHAR,
         iiId AS INT,
         icText AS CHAR,
         OUTPUT ocType AS CHAR):
             
    DEFINE VARIABLE ribbonGroup1 AS Infragistics.Win.UltraWinToolbars.RibbonGroup NO-UNDO.
    ribbonGroup1 = NEW Infragistics.Win.UltraWinToolbars.RibbonGroup(icText).

    ocType = ribbonGroup1:GetClass():TypeName.
    
    ribbonGroup1:Caption = icText.
    DEFINE VARIABLE arrayvar0 AS Infragistics.Win.UltraWinToolbars.RibbonGroup EXTENT 1 NO-UNDO.
    arrayvar0[1] = ribbonGroup1.

    IF icParentType = "Infragistics.Win.UltraWinToolbars.RibbonTab" THEN
      CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonTab"):Groups:AddRange(arrayvar0).

    RETURN CAST(ribbonGroup1,"Progress.Lang.Object"). 
  END METHOD.    
      
  METHOD PUBLIC Progress.Lang.Object AddRibbonButtonTool 
        (ioParent       AS Progress.Lang.Object,
         icParentType   AS CHAR,
         iiId           AS INT, 
         icText         AS CHAR,
         icImage        AS CHAR,
         icAccel        AS CHAR,
         ibLarge        AS LOG,
         ibFirstInGroup AS LOG,
         OUTPUT ocType  AS CHAR):
  
    DEFINE VARIABLE ButtonTool1 AS Infragistics.Win.UltraWinToolbars.ButtonTool NO-UNDO.
    DEFINE VARIABLE appearance1 AS Infragistics.Win.Appearance NO-UNDO.
    
    ButtonTool1 = NEW Infragistics.Win.UltraWinToolbars.ButtonTool(STRING(iiId)).

    ocType = ButtonTool1:GetClass():TypeName.

    ButtonTool1:SharedPropsInternal:Caption = icText.
    IF icAccel NE "" THEN 
      THIS-OBJECT:setButtonToolShortcut(ButtonTool1,icAccel).
    
    IF icImage NE "" AND SEARCH(icImage) NE ? THEN DO:     
      appearance1 = NEW Infragistics.Win.Appearance().
      IF menuToolImgList:Images:IndexOfKey(icImage) GE 0 THEN
        appearance1:Image = menuToolImgList:Images[icImage].
      ELSE   
        appearance1:Image = System.Drawing.Image:FromFile(SEARCH(icImage)).

      IF ibLarge THEN        
        buttonTool1:SharedPropsInternal:AppearancesLarge:Appearance = appearance1.
      buttonTool1:SharedPropsInternal:AppearancesSmall:Appearance = appearance1.
    END.        
             
    DEFINE VARIABLE arrayvar1 AS Infragistics.Win.UltraWinToolbars.ToolBase EXTENT 1 NO-UNDO.
    arrayvar1[1] = buttonTool1.
    THIS-OBJECT:ultraToolbarsManager1:Tools:AddRange(arrayvar1).

    IF icParentType = "Infragistics.Win.UltraWinToolbars.RibbonGroup" THEN DO:
      CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools:AddRange(arrayvar1).
      IF ibLarge THEN 
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
      CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
    END.  
    ELSE IF icParentType = "Infragistics.Win.UltraWinToolbars.PopupMenuTool" THEN DO: 
      CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools:AddRange(arrayvar1).
      IF ibLarge THEN 
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
      CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
    END.
    ELSE IF icParentType = "ultraToolbarsManager1:Ribbon:QuickAccessToolbar" THEN 
      THIS-OBJECT:ultraToolbarsManager1:Ribbon:QuickAccessToolbar:Tools:AddRange(arrayvar1).
    ELSE DO:
/*          ButtonTool1:Settings:UseLargeImages = Infragistics.Win.DefaultableBoolean:False. */
      THIS-OBJECT:ultraToolbarsManager1:Ribbon:ApplicationMenu:ToolAreaLeft:Tools:AddRange(arrayvar1).
    END.    
    
    IF CAN-DO(cQuickAccessNodes,STRING(iiId)) THEN DO:
        
      IF icImage = "" THEN DO:
        appearance1 = NEW Infragistics.Win.Appearance().          
        IF SEARCH("bmp\log16e.bmp") NE ? THEN
          appearance1:Image = System.Drawing.Image:FromFile(SEARCH("bmp\log16e.bmp")). 
        arrayvar1[1]:SharedPropsInternal:AppearancesSmall:Appearance = appearance1.
      END.
        
      THIS-OBJECT:ultraToolbarsManager1:Ribbon:QuickAccessToolbar:Tools:AddRange(arrayvar1).
    END.  
      
    RETURN CAST(ButtonTool1,"Progress.Lang.Object"). 
  END METHOD.        

  METHOD PUBLIC Progress.Lang.Object AddRibbonStateButtonTool 
        (ioParent       AS Progress.Lang.Object,
         icParentType   AS CHAR,
         iiId           AS INT, 
         icText         AS CHAR,
         icImage        AS CHAR,
         icAccel        AS CHAR,
         ibLarge        AS LOG,
         ibFirstInGroup AS LOG,
         OUTPUT ocType  AS CHAR):
  
      DEFINE VARIABLE ButtonTool1 AS Infragistics.Win.UltraWinToolbars.StateButtonTool NO-UNDO.
      ButtonTool1 = NEW Infragistics.Win.UltraWinToolbars.StateButtonTool(STRING(iiId)).

      ocType = ButtonTool1:GetClass():TypeName.

      ButtonTool1:SharedPropsInternal:Caption = icText.
      IF icAccel NE "" THEN
        THIS-OBJECT:setButtonToolShortcut(ButtonTool1,icAccel).
      
      IF icImage NE "" THEN DO:                
        DEFINE VARIABLE appearance1 AS Infragistics.Win.Appearance NO-UNDO.
        appearance1 = NEW Infragistics.Win.Appearance().
        appearance1:Image = System.Drawing.Image:FromFile(SEARCH(icImage)).

        IF ibLarge THEN        
          buttonTool1:SharedPropsInternal:AppearancesLarge:Appearance = appearance1.
        ELSE
          buttonTool1:SharedPropsInternal:AppearancesSmall:Appearance = appearance1.
      END.        
               
      DEFINE VARIABLE arrayvar1 AS Infragistics.Win.UltraWinToolbars.ToolBase EXTENT 1 NO-UNDO.
      arrayvar1[1] = buttonTool1.
      THIS-OBJECT:ultraToolbarsManager1:Tools:AddRange(arrayvar1).

      IF icParentType = "Infragistics.Win.UltraWinToolbars.RibbonGroup" THEN DO:
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools:AddRange(arrayvar1).
        IF ibLarge THEN 
          CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
      END.  
      ELSE DO: 
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools:AddRange(arrayvar1).
        IF ibLarge THEN 
          CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
      END.
      
      RETURN CAST(ButtonTool1,"Progress.Lang.Object"). 
  END METHOD.        

  METHOD PUBLIC Progress.Lang.Object AddRibbonPopupMenuTool
        (ioParent       AS Progress.Lang.Object,
         icParentType   AS CHAR,
         iiId           AS INT, 
         icText         AS CHAR,
         icImage        AS CHAR,
         icAccel        AS CHAR,
         ibLarge        AS LOG,
         ibFirstInGroup AS LOG,
         OUTPUT ocType  AS CHAR):

      ocType = "Infragistics.Win.UltraWinToolbars.PopupMenuTool".

      DEFINE VARIABLE popupMenuTool1 AS Infragistics.Win.UltraWinToolbars.PopupMenuTool NO-UNDO.
      popupMenuTool1 = NEW Infragistics.Win.UltraWinToolbars.PopupMenuTool(STRING(iiId)).
              
      DEFINE VARIABLE appearance1 AS Infragistics.Win.Appearance NO-UNDO.
      appearance1 = NEW Infragistics.Win.Appearance().
      IF icImage NE "" AND SEARCH(icImage) NE ? THEN
        appearance1:Image = System.Drawing.Image:FromFile(SEARCH(icImage)).

      popupMenuTool1:SharedPropsInternal:AppearancesSmall:Appearance = appearance1.

      popupMenuTool1:SharedPropsInternal:Caption = icText.
                     
               
      DEFINE VARIABLE arrayvar1 AS Infragistics.Win.UltraWinToolbars.ToolBase EXTENT 1 NO-UNDO.
      arrayvar1[1] = popupMenuTool1.
      THIS-OBJECT:ultraToolbarsManager1:Tools:AddRange(arrayvar1).

      IF icParentType = "Infragistics.Win.UltraWinToolbars.RibbonGroup" THEN DO:
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools:AddRange(arrayvar1).
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
      END.  
      ELSE IF icParentType = "Infragistics.Win.UltraWinToolbars.PopupMenuTool" THEN DO: 
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools:AddRange(arrayvar1).
        CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:IsFirstInGroup = ibFirstInGroup.
      END.
      ELSE DO:
        popupMenuTool1:Settings:UseLargeImages = Infragistics.Win.DefaultableBoolean:False.
        THIS-OBJECT:ultraToolbarsManager1:Ribbon:ApplicationMenu:ToolAreaLeft:Tools:AddRange(arrayvar1).
      END.  
      

      IF ibLarge THEN DO:
        IF icParentType = "Infragistics.Win.UltraWinToolbars.RibbonGroup" THEN
          CAST(ioParent,"Infragistics.Win.UltraWinToolbars.RibbonGroup"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
        ELSE IF icParentType = "Infragistics.Win.UltraWinToolbars.PopupMenuTool" THEN  
          CAST(ioParent,"Infragistics.Win.UltraWinToolbars.PopupMenuTool"):Tools[STRING(iiId)]:InstanceProps:PreferredSizeOnRibbon = Infragistics.Win.UltraWinToolbars.RibbonToolSize:Large.
      END.

      IF CAN-DO(cQuickAccessNodes,STRING(iiId)) THEN DO:
        IF icImage = "" THEN DO:
          appearance1 = NEW Infragistics.Win.Appearance().            
          IF SEARCH("tvpics\FoldOpen.bmp") NE ? THEN
            appearance1:Image = System.Drawing.Image:FromFile(SEARCH("tvpics\FoldOpen.bmp")).
          arrayvar1[1]:SharedPropsInternal:AppearancesSmall:Appearance = appearance1.
        END.  
        THIS-OBJECT:ultraToolbarsManager1:Ribbon:QuickAccessToolbar:Tools:AddRange(arrayvar1).
      END.  
      
      RETURN CAST(PopupMenuTool1,"Progress.Lang.Object"). 
           
  END METHOD. 

  METHOD PUBLIC CHARACTER getQuickAccessToolsKeyList 
        ():
                  
      DEFINE VARIABLE ix           AS INT NO-UNDO.   
      DEFINE VARIABLE iCnt         AS INT NO-UNDO.           
      DEFINE VARIABLE QAT1         AS Infragistics.Win.UltraWinToolbars.QuickAccessToolbar NO-UNDO.
      DEFINE VARIABLE cKeyList     AS CHAR NO-UNDO.
      
      QAT1 = THIS-OBJECT:ultraToolbarsManager1:Ribbon:QuickAccessToolbar.
      iCnt = QAT1:Tools:Count.
      
      DO ix = 0 TO iCnt - 1:
        cKeyList = cKeyList + (IF cKeyList NE "" THEN "," ELSE "") + STRING(QAT1:Tools:Item[ix]:Key).
      END.
      RETURN cKeyList.      
      
  END METHOD.    

  
  METHOD PUBLIC LOGICAL RemoveRibbonGroup 
        (ioGroup AS Progress.Lang.Object):
                  
      DEFINE VARIABLE ix           AS INT NO-UNDO.   
      DEFINE VARIABLE iCnt         AS INT NO-UNDO.           
      DEFINE VARIABLE ribbonGroup1 AS Infragistics.Win.UltraWinToolbars.RibbonGroup NO-UNDO.
      ribbonGroup1 = CAST(ioGroup,"Infragistics.Win.UltraWinToolbars.RibbonGroup").
      iCnt = ribbonGroup1:Tools:Count.
      
      DO ix = 0 TO iCnt - 1:
        IF ribbonGroup1:Tools:Item[ix]:GetClass():TypeName = "Infragistics.Win.UltraWinToolbars.ButtonTool" THEN
          THIS-OBJECT:RemoveRibbonButtonTool(CAST(ribbonGroup1:Tools:Item[ix],"Progress.Lang.Object")).
        ELSE IF ribbonGroup1:Tools:Item[ix]:GetClass():TypeName = "Infragistics.Win.UltraWinToolbars.StateButtonTool" THEN
          THIS-OBJECT:RemoveRibbonStateButtonTool(CAST(ribbonGroup1:Tools:Item[ix],"Progress.Lang.Object")).
        ELSE IF ribbonGroup1:Tools:Item[ix]:GetClass():TypeName = "Infragistics.Win.UltraWinToolbars.PopupMenuTool" THEN
          THIS-OBJECT:RemoveRibbonPopupMenuTool(CAST(ribbonGroup1:Tools:Item[ix],"Progress.Lang.Object")).
      END.      
      
      ribbonGroup1:Tab:Groups:Remove(ribbonGroup1).
      ribbonGroup1:Dispose().
      RETURN YES. 
  END METHOD.    
  
  METHOD PUBLIC LOGICAL RemoveRibbonButtonTool
      (ioTool AS Progress.Lang.Object):
      DEFINE VARIABLE ButtonTool1 AS Infragistics.Win.UltraWinToolbars.ButtonTool NO-UNDO.
      ButtonTool1 = CAST(ioTool,"Infragistics.Win.UltraWinToolbars.ButtonTool").
      ButtonTool1:Dispose().
      THIS-OBJECT:ultraToolbarsManager1:Tools:Remove(ButtonTool1).
      
      RETURN YES.
  END METHOD.

  METHOD PUBLIC LOGICAL RemoveRibbonStateButtonTool
      (ioTool AS Progress.Lang.Object):
      DEFINE VARIABLE ButtonTool1 AS Infragistics.Win.UltraWinToolbars.StateButtonTool NO-UNDO.
      ButtonTool1 = CAST(ioTool,"Infragistics.Win.UltraWinToolbars.StateButtonTool").
      ButtonTool1:Dispose().
      THIS-OBJECT:ultraToolbarsManager1:Tools:Remove(ButtonTool1).
      
      RETURN YES.
  END METHOD.
       
  METHOD PUBLIC LOGICAL RemoveRibbonPopupMenuTool 
        (ioPopupMenu AS Progress.Lang.Object):
                  
      DEFINE VARIABLE ix           AS INT NO-UNDO.   
      DEFINE VARIABLE iCnt         AS INT NO-UNDO.           
      DEFINE VARIABLE popupMenu1 AS Infragistics.Win.UltraWinToolbars.PopupMenuTool NO-UNDO.
      popupMenu1 = CAST(ioPopupMenu,"Infragistics.Win.UltraWinToolbars.PopupMenuTool").
      iCnt = popupMenu1:Tools:Count.
      
      DO ix = 1 TO iCnt:
        IF popupMenu1:Tools:Item[0]:GetClass():TypeName = "Infragistics.Win.UltraWinToolbars.ButtonTool" THEN
          THIS-OBJECT:RemoveRibbonButtonTool(CAST(popupMenu1:Tools:Item[0],"Progress.Lang.Object")).
        ELSE IF popupMenu1:Tools:Item[0]:GetClass():TypeName = "Infragistics.Win.UltraWinToolbars.PopupMenuTool" THEN
          THIS-OBJECT:RemoveRibbonPopupMenuTool(CAST(popupMenu1:Tools:Item[0],"Progress.Lang.Object")).
      END.      
      RETURN YES. 
  END METHOD.    
  
  METHOD PUBLIC LOGICAL setButtonToolShortcut (ioButtonTool AS Infragistics.Win.UltraWinToolbars.ButtonTool,icAccel AS CHAR):        
    CASE icAccel:
        WHEN "ctrl-A" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlA.
        WHEN "ctrl-B" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlB.
        WHEN "ctrl-C" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlC.
        WHEN "ctrl-D" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlD.
        WHEN "ctrl-E" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlE.
        WHEN "ctrl-F" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlF.
        WHEN "ctrl-G" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlG.
        WHEN "ctrl-H" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlH.
        WHEN "ctrl-I" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlI.
        WHEN "ctrl-J" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlJ.
        WHEN "ctrl-K" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlK.
        WHEN "ctrl-L" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlL.
        WHEN "ctrl-M" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlM.
        WHEN "ctrl-N" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlN.
        WHEN "ctrl-O" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlO.
        WHEN "ctrl-P" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlP.
        WHEN "ctrl-Q" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlQ.
        WHEN "ctrl-R" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlR.
        WHEN "ctrl-S" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlS.
        WHEN "ctrl-T" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlT.
        WHEN "ctrl-U" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlU.
        WHEN "ctrl-V" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlV.
        WHEN "ctrl-W" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlW.
        WHEN "ctrl-X" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlX.
        WHEN "ctrl-Y" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlY.
        WHEN "ctrl-Z" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:CtrlZ.

        WHEN "F1"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F1.
        WHEN "F2"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F2.
        WHEN "F3"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F3.
        WHEN "F4"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F4.
        WHEN "F5"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F5.
        WHEN "F6"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F6.
        WHEN "F7"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F7.
        WHEN "F8"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F8.
        WHEN "F9"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F9.
        WHEN "F10" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F10.
        WHEN "F11" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F11.
        WHEN "F12" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:F12.

        WHEN "shift-F1"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF1.
        WHEN "shift-F2"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF2.
        WHEN "shift-F3"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF3.
        WHEN "shift-F4"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF4.
        WHEN "shift-F5"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF5.
        WHEN "shift-F6"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF6.
        WHEN "shift-F7"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF7.
        WHEN "shift-F8"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF8.
        WHEN "shift-F9"  THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF9.
        WHEN "shift-F10" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF10.
        WHEN "shift-F11" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF11.
        WHEN "shift-F12" THEN ioButtonTool:SharedPropsInternal:Shortcut = System.Windows.Forms.Shortcut:ShiftF12.

      END CASE.
  END METHOD.

  METHOD PUBLIC LOGICAL setMenuToolImage (piMenuItem AS INT,icImage AS CHAR):
    DEF VAR iIdx AS INT NO-UNDO.
    IF icImage NE "" AND SEARCH(icImage) NE ? THEN DO:     
      IF menuToolImgList:Images:IndexOfKey(icImage) = -1 THEN
        menuToolImgList:Images:Add(icImage,System.Drawing.Image:FromFile(SEARCH(icImage))).
      
      DEFINE VARIABLE appearance1 AS Infragistics.Win.Appearance NO-UNDO.
      appearance1 = NEW Infragistics.Win.Appearance().
      appearance1:Image = menuToolImgList:Images[icImage].
/*      appearance1:Image = System.Drawing.Image:FromFile(SEARCH(icImage)).*/

      iIdx = ultraToolbarsManager1:Tools:IndexOf(STRING(piMenuItem)).
      IF iIdx NE -1 THEN 
        CAST(ultraToolbarsManager1:Tools:GetItem(iIdx), ToolBase):SharedPropsInternal:AppearancesSmall:Appearance = appearance1.
    END.                      
  END METHOD.   
     
END CLASS.
